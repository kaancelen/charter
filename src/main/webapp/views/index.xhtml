<ui:composition  xmlns="http://www.w3.org/1999/xhtml"  
    xmlns:h="http://java.sun.com/jsf/html"  
    xmlns:f="http://java.sun.com/jsf/core"  
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    template="/template/main.xhtml">  

	<ui:define name="menuitem">
		<h:form id="indexForm">
			<p:dataTable id="consolTable" widgetVar="consolTable" emptyMessage="Hiç kayıt bulunmamaktadır."
				value="#{mainController.consolidated.records}" var="record" resizableColumns="false" style="text-align:center"
				paginator="true" rows="20" styleClass="paginated" paginatorPosition="top" paginatorAlwaysVisible="false" rowsPerPageTemplate="20,50,100" >
			
				<f:facet name="header">
					<p:commandButton value="Dosya Yükle" oncomplete="PF('uploadFile').show()"/>
		      		<p:outputLabel value="Yüklü Dosya : #{mainController.consolidated.filename}, yüklenme Tarihi :" style="margin-left:20px;"/>
		      		<p:outputLabel value="#{mainController.consolidated.uploadedDate}">
		      			<f:convertDateTime pattern="dd/MM/yy HH:mm"/>
		      		</p:outputLabel>
		      		<p:commandButton value="Çizdir" icon="ui-icon-pencil" action="#{mainController.drawCharts}" update=":chartDlgForm" oncomplete="PF('chartDlg').show()"
		      			disabled="#{empty mainController.consolidated.filepath}"/>
				</f:facet>
			
				<p:column headerText="Dönem" style="width:10%" filterMatchMode="contains" filterBy="#{record.term}">
					<p:outputLabel value="#{record.term}"/>
				</p:column>
				<p:column headerText="Üye Tipi" style="width:10%" filterMatchMode="contains" filterBy="#{record.memberType}">
					<p:outputLabel value="#{record.memberType}"/>
				</p:column>
				<p:column headerText="Üye Kodu" style="width:10%" filterMatchMode="contains" filterBy="#{record.memberCode}">
					<p:outputLabel value="#{record.memberCode}"/>
				</p:column>
				<p:column headerText="Risk Kodu" style="width:10%" filterMatchMode="contains" filterBy="#{record.riskCode}">
					<p:outputLabel value="#{record.riskCode}"/>
				</p:column>
				<p:column headerText="Kredi Limiti" style="width:10%">
					<p:outputLabel value="#{record.limit}">
						<f:convertNumber pattern=""/>
					</p:outputLabel>
				</p:column>
				<p:column headerText="1-12 risk" style="width:10%">
					<p:outputLabel value="#{record.shortTermRisk}">
						<f:convertNumber pattern="" />
					</p:outputLabel>
				</p:column>
				<p:column headerText="12-24 risk" style="width:10%">
					<p:outputLabel value="#{record.middleTermRisk}">
						<f:convertNumber pattern="" />
					</p:outputLabel>
				</p:column>
				<p:column headerText="24+ risk" style="width:10%">
					<p:outputLabel value="#{record.longTermRisk}">
						<f:convertNumber pattern="" />
					</p:outputLabel>
				</p:column>
				<p:column headerText="Tahakkuk" style="width:10%">
					<p:outputLabel value="#{record.tahakkuk}">
						<f:convertNumber pattern="" />
					</p:outputLabel>
				</p:column>
				<p:column headerText="Reeskont" style="width:10%">
					<p:outputLabel value="#{record.reeskont}">
						<f:convertNumber pattern="" />
					</p:outputLabel>
				</p:column>
				<p:column headerText="Finans Kodu" style="width:10%">
					<p:outputLabel value="#{record.finansCode}"/>
				</p:column>
			</p:dataTable>
		</h:form>
		<!-- DIALOGSS -->
      	<p:dialog widgetVar="uploadFile" modal="true" appendTo="@(body)" resizable="false" draggable="false"
      		header="Dosya yükle">
      		<h:form id="uploadFileForm" >
      			<p:messages id="messages" autoUpdate="true"/>
      			<p:outputLabel value="Önce dosyayı seçin daha sonra yükle butonu ile yükleyin." style="color:blue;"/>
				<br/>
				<p:outputLabel value="İzinli dosya uzantıları : (xls/x)" style="color:red;"/>
				<br/>
				<p:outputLabel value="Max. dosya boyutu 5mb" style="color:red;"/>
				<br/>
      			<p:fileUpload id="fileUpload" mode="advanced" sizeLimit="5000000" allowTypes="/(\.|\/)(xls|xlsx)$/"
      				fileUploadListener="#{mainController.onUploadFile}"	update=":indexForm:consolTable"/>
      			<br/>
      			<p:commandButton value="Tamamla" icon="ui-icon-check" oncomplete="PF('uploadFile').hide()" update=":indexForm:consolTable"
      				action="#{mainController.onCompleteFileUpload}"/>
      		</h:form>
      	</p:dialog>
      	<!-- Charts dialog -->
      	<p:dialog widgetVar="chartDlg" modal="true" appendTo="@(body)" resizable="false" draggable="false" header="Grafikler">
      		<h:form id="chartDlgForm">
      			<p:tabView>
<!--       				<p:ajax event="tabChange" listener="#{mainController.onTabChange}" update=":chartDlgForm:termDataTable"/> -->
      				<p:tab title="1">
      					<p:chart type="bar" model="#{mainController.nakitRisk}" style="height:500px;width:800px;"/>
      				</p:tab>
      				<p:tab title="2">
      					<p:chart type="bar" model="#{mainController.limitRisk}" style="height:500px;width:800px;"/>
      				</p:tab>
      				<p:tab title="3">
      					<p:chart type="bar" model="#{mainController.termNakitRisk}" style="height:500px;width:800px;"/>
      				</p:tab>
      				<p:tab title="4">
      					<p:chart type="bar" model="#{mainController.facLeaRisk}" style="height:500px;width:800px;"/>
      				</p:tab>
      				<p:tab title="5">
      					<p:chart type="bar" model="#{mainController.gnakitRisk}" style="height:500px;width:800px;"/>
      				</p:tab>
      				<p:tab title="6">
      					<p:chart type="bar" model="#{mainController.glimitRisk}" style="height:500px;width:800px;"/>
      				</p:tab>
      				<p:tab title="7">
      					<p:chart type="bar" model="#{mainController.termGnakitRisk}" style="height:500px;width:800px;"/>
      				</p:tab>
      			</p:tabView>
<!--       			<p:dataTable id="termDataTable" emptyMessage="Data yok!" style="width:800px;" value="#{mainController.tableData}" var="data"> -->
<!--       				<p:column headerText="Bar"> -->
<!--       					<p:outputLabel value="Deneme"/> -->
<!--       				</p:column> -->
<!--       				<p:columns value="#{mainController.columns}" var="column"> -->
<!--       					<f:facet name="header"> -->
<!--       						<p:outputLabel value="#{column.header}"/> -->
<!--       					</f:facet> -->
<!--       					<p:outputLabel value="#{data.get(column.property)}"> -->
<!--       						<f:convertNumber pattern="" /> -->
<!--       					</p:outputLabel> -->
<!--       				</p:columns> -->
<!--       			</p:dataTable> -->
      		</h:form>
      	</p:dialog>
		<f:metadata>
			<f:event listener="#{mainController.onPageLoad}" type="preRenderView"/>
		</f:metadata>
	</ui:define>
</ui:composition>